!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.bfbSDK=n():t.bfbSDK=n()}(self,(()=>(()=>{console.log("bfbstat.js version is v1.0.2");const t="https://api.baofenbao.com/api/v1/stat/page";let n,e=0,o=0,r=0,i="";var a,c;async function s(){const t=document.querySelectorAll("[add-wechat-url]"),n=await m(window.location.href);t.forEach((t=>{const e=t.getAttribute("add-wechat-url"),o=d(e);t.hasAttribute("setted")||(t.addEventListener("click",(()=>{h(o);const t=e+"_"+n;window.location=t})),t.setAttribute("setted","1"))}))}function d(t){const n=t.split("?")[1];if(!n)return null;const e=n.split("&"),o={};for(const t of e){const[n,e]=t.split("=");o[n]=decodeURIComponent(e)}return o.customer_channel}function u(){var t=navigator.userAgent;return/mobile|tablet|ip(ad|hone|od)|android/i.test(t)||/iPad|tablet/i.test(t)?"Mobile":"Desktop"}function l(){const t=document.documentElement.scrollHeight,n=window.scrollY||document.documentElement.scrollTop,o=window.innerHeight||document.documentElement.clientHeight;e=(n+o)/t*100}async function f(){const n=window.location.href,e=m(n);if(localStorage.curUrlHash===e)return;const a={url:n,urlHash:e.toLowerCase(),deviceType:u(),viewingRatio:o,viewingTime:Math.round(r),dataType:0,accountKey:i,bindKey:i},c=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(c.ok){const t=await c.json(),{result:n}=t;"ok"==n&&(localStorage.curUrlHash=e)}}async function h(n){const e=window.location.href,a={url:e,urlHash:m(e).toLowerCase(),customerChannel:n,deviceType:u(),viewingRatio:o,viewingTime:Math.round(r),dataType:1,bindKey:i},c=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});c.ok&&await c.json()}c=document.currentScript.src,a=new URLSearchParams(c.split("?")[1]),i=a.get("id"),f(),window.onload=function(){s(),function(){const t=new MutationObserver(w),n=document.body;t.observe(n,{attributes:!0,childList:!0,subtree:!0,characterData:!0})}()},setInterval((()=>{if(n){const t=performance.now()-n;t>r&&(r=t)}}),1e3),window.addEventListener("DOMContentLoaded",(function(){n||(n=performance.now()),s(),l(),window.addEventListener("scroll",(function(){l(),e>o&&(o=e.toFixed(2))}))}));const w=function(t){for(let n of t)"childList"===n.type&&s()};var p={};function m(t){function n(t,n){var e,o,r,i,a;return r=2147483648&t,i=2147483648&n,a=(1073741823&t)+(1073741823&n),(e=1073741824&t)&(o=1073741824&n)?2147483648^a^r^i:e|o?1073741824&a?3221225472^a^r^i:1073741824^a^r^i:a^r^i}function e(t,e,o,r,i,a,c){return t=n(t,n(n(e&o|~e&r,i),c)),n(t<<a|t>>>32-a,e)}function o(t,e,o,r,i,a,c){return t=n(t,n(n(e&r|o&~r,i),c)),n(t<<a|t>>>32-a,e)}function r(t,e,o,r,i,a,c){return t=n(t,n(n(e^o^r,i),c)),n(t<<a|t>>>32-a,e)}function i(t,e,o,r,i,a,c){return t=n(t,n(n(o^(e|~r),i),c)),n(t<<a|t>>>32-a,e)}function a(t){var n,e="",o="";for(n=0;3>=n;n++)e+=(o="0"+(o=t>>>8*n&255).toString(16)).substr(o.length-2,2);return e}var c,s,d,u,l,f,h,w,p;for(t=function(t){t=t.replace(/\r\n/g,"\n");for(var n="",e=0;e<t.length;e++){var o=t.charCodeAt(e);128>o?n+=String.fromCharCode(o):(127<o&&2048>o?n+=String.fromCharCode(o>>6|192):(n+=String.fromCharCode(o>>12|224),n+=String.fromCharCode(o>>6&63|128)),n+=String.fromCharCode(63&o|128))}return n}(t),c=function(t){for(var n,e=t.length,o=16*(((n=e+8)-n%64)/64+1),r=Array(o-1),i=0,a=0;a<e;)i=a%4*8,r[n=(a-a%4)/4]|=t.charCodeAt(a)<<i,a++;return r[n=(a-a%4)/4]|=128<<a%4*8,r[o-2]=e<<3,r[o-1]=e>>>29,r}(t),f=1732584193,h=4023233417,w=2562383102,p=271733878,t=0;t<c.length;t+=16)s=f,d=h,u=w,l=p,f=e(f,h,w,p,c[t+0],7,3614090360),p=e(p,f,h,w,c[t+1],12,3905402710),w=e(w,p,f,h,c[t+2],17,606105819),h=e(h,w,p,f,c[t+3],22,3250441966),f=e(f,h,w,p,c[t+4],7,4118548399),p=e(p,f,h,w,c[t+5],12,1200080426),w=e(w,p,f,h,c[t+6],17,2821735955),h=e(h,w,p,f,c[t+7],22,4249261313),f=e(f,h,w,p,c[t+8],7,1770035416),p=e(p,f,h,w,c[t+9],12,2336552879),w=e(w,p,f,h,c[t+10],17,4294925233),h=e(h,w,p,f,c[t+11],22,2304563134),f=e(f,h,w,p,c[t+12],7,1804603682),p=e(p,f,h,w,c[t+13],12,4254626195),w=e(w,p,f,h,c[t+14],17,2792965006),f=o(f,h=e(h,w,p,f,c[t+15],22,1236535329),w,p,c[t+1],5,4129170786),p=o(p,f,h,w,c[t+6],9,3225465664),w=o(w,p,f,h,c[t+11],14,643717713),h=o(h,w,p,f,c[t+0],20,3921069994),f=o(f,h,w,p,c[t+5],5,3593408605),p=o(p,f,h,w,c[t+10],9,38016083),w=o(w,p,f,h,c[t+15],14,3634488961),h=o(h,w,p,f,c[t+4],20,3889429448),f=o(f,h,w,p,c[t+9],5,568446438),p=o(p,f,h,w,c[t+14],9,3275163606),w=o(w,p,f,h,c[t+3],14,4107603335),h=o(h,w,p,f,c[t+8],20,1163531501),f=o(f,h,w,p,c[t+13],5,2850285829),p=o(p,f,h,w,c[t+2],9,4243563512),w=o(w,p,f,h,c[t+7],14,1735328473),f=r(f,h=o(h,w,p,f,c[t+12],20,2368359562),w,p,c[t+5],4,4294588738),p=r(p,f,h,w,c[t+8],11,2272392833),w=r(w,p,f,h,c[t+11],16,1839030562),h=r(h,w,p,f,c[t+14],23,4259657740),f=r(f,h,w,p,c[t+1],4,2763975236),p=r(p,f,h,w,c[t+4],11,1272893353),w=r(w,p,f,h,c[t+7],16,4139469664),h=r(h,w,p,f,c[t+10],23,3200236656),f=r(f,h,w,p,c[t+13],4,681279174),p=r(p,f,h,w,c[t+0],11,3936430074),w=r(w,p,f,h,c[t+3],16,3572445317),h=r(h,w,p,f,c[t+6],23,76029189),f=r(f,h,w,p,c[t+9],4,3654602809),p=r(p,f,h,w,c[t+12],11,3873151461),w=r(w,p,f,h,c[t+15],16,530742520),f=i(f,h=r(h,w,p,f,c[t+2],23,3299628645),w,p,c[t+0],6,4096336452),p=i(p,f,h,w,c[t+7],10,1126891415),w=i(w,p,f,h,c[t+14],15,2878612391),h=i(h,w,p,f,c[t+5],21,4237533241),f=i(f,h,w,p,c[t+12],6,1700485571),p=i(p,f,h,w,c[t+3],10,2399980690),w=i(w,p,f,h,c[t+10],15,4293915773),h=i(h,w,p,f,c[t+1],21,2240044497),f=i(f,h,w,p,c[t+8],6,1873313359),p=i(p,f,h,w,c[t+15],10,4264355552),w=i(w,p,f,h,c[t+6],15,2734768916),h=i(h,w,p,f,c[t+13],21,1309151649),f=i(f,h,w,p,c[t+4],6,4149444226),p=i(p,f,h,w,c[t+11],10,3174756917),w=i(w,p,f,h,c[t+2],15,718787259),h=i(h,w,p,f,c[t+9],21,3951481745),f=n(f,s),h=n(h,d),w=n(w,u),p=n(p,l);return(a(f)+a(h)+a(w)+a(p)).toLowerCase()}return p.toWechatPage=async function(t){const n=await m(window.location.href);h(d(t));const e=t+"_"+n;window.location=e},p.addHkLink=async function(t){d(t),f()},window.BFB=p,{}})()));