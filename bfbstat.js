!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.bfbSDK=n():t.bfbSDK=n()}(self,(()=>(()=>{const t="https://api.baofenbao.com/api/v1/stat/page";let n,o=0,e=0,r=0,i="";var c,a;async function s(){const t=document.querySelectorAll("[add-wechat-url]"),n=await m(window.location.href);t.forEach((t=>{const o=t.getAttribute("add-wechat-url"),e=d(o);t.addEventListener("click",(()=>{w(e);const t=o+"_"+n;window.location=t}))}))}function d(t){const n=t.split("?")[1];if(!n)return null;const o=n.split("&"),e={};for(const t of o){const[n,o]=t.split("=");e[n]=decodeURIComponent(o)}return e.customer_channel}function u(){var t=navigator.userAgent;return/mobile|tablet|ip(ad|hone|od)|android/i.test(t)||/iPad|tablet/i.test(t)?"Mobile":"Desktop"}function l(){const t=document.documentElement.scrollHeight,n=window.scrollY||document.documentElement.scrollTop,e=window.innerHeight||document.documentElement.clientHeight;o=(n+e)/t*100}async function f(){const n=window.location.href,o=m(n);if(localStorage.curUrlHash===o)return;const c={url:n,urlHash:o.toLowerCase(),deviceType:u(),viewingRatio:e,viewingTime:Math.round(r),dataType:0,accountKey:i,bindKey:i},a=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(a.ok){const t=await a.json(),{result:n}=t;"ok"==n&&(localStorage.curUrlHash=o)}}async function w(n){const o=window.location.href,c={url:o,urlHash:m(o).toLowerCase(),customerChannel:n,deviceType:u(),viewingRatio:e,viewingTime:Math.round(r),dataType:1,bindKey:i},a=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(a.ok){const t=await a.json();console.log(t)}}a=document.currentScript.src,c=new URLSearchParams(a.split("?")[1]),i=c.get("id"),f(),window.onload=function(){!function(){const t=new MutationObserver(h),n=document.body;t.observe(n,{attributes:!0,childList:!0,subtree:!0,characterData:!0})}()},setInterval((()=>{if(n){const t=performance.now()-n;t>r&&(r=t)}}),1e3),window.addEventListener("DOMContentLoaded",(function(){n||(n=performance.now()),s(),l(),window.addEventListener("scroll",(function(){l(),o>e&&(e=o.toFixed(2))}))}));const h=function(t){for(let n of t)"childList"===n.type&&s()};var p={};function m(t){function n(t,n){var o,e,r,i,c;return r=2147483648&t,i=2147483648&n,c=(1073741823&t)+(1073741823&n),(o=1073741824&t)&(e=1073741824&n)?2147483648^c^r^i:o|e?1073741824&c?3221225472^c^r^i:1073741824^c^r^i:c^r^i}function o(t,o,e,r,i,c,a){return t=n(t,n(n(o&e|~o&r,i),a)),n(t<<c|t>>>32-c,o)}function e(t,o,e,r,i,c,a){return t=n(t,n(n(o&r|e&~r,i),a)),n(t<<c|t>>>32-c,o)}function r(t,o,e,r,i,c,a){return t=n(t,n(n(o^e^r,i),a)),n(t<<c|t>>>32-c,o)}function i(t,o,e,r,i,c,a){return t=n(t,n(n(e^(o|~r),i),a)),n(t<<c|t>>>32-c,o)}function c(t){var n,o="",e="";for(n=0;3>=n;n++)o+=(e="0"+(e=t>>>8*n&255).toString(16)).substr(e.length-2,2);return o}var a,s,d,u,l,f,w,h,p;for(t=function(t){t=t.replace(/\r\n/g,"\n");for(var n="",o=0;o<t.length;o++){var e=t.charCodeAt(o);128>e?n+=String.fromCharCode(e):(127<e&&2048>e?n+=String.fromCharCode(e>>6|192):(n+=String.fromCharCode(e>>12|224),n+=String.fromCharCode(e>>6&63|128)),n+=String.fromCharCode(63&e|128))}return n}(t),a=function(t){for(var n,o=t.length,e=16*(((n=o+8)-n%64)/64+1),r=Array(e-1),i=0,c=0;c<o;)i=c%4*8,r[n=(c-c%4)/4]|=t.charCodeAt(c)<<i,c++;return r[n=(c-c%4)/4]|=128<<c%4*8,r[e-2]=o<<3,r[e-1]=o>>>29,r}(t),f=1732584193,w=4023233417,h=2562383102,p=271733878,t=0;t<a.length;t+=16)s=f,d=w,u=h,l=p,f=o(f,w,h,p,a[t+0],7,3614090360),p=o(p,f,w,h,a[t+1],12,3905402710),h=o(h,p,f,w,a[t+2],17,606105819),w=o(w,h,p,f,a[t+3],22,3250441966),f=o(f,w,h,p,a[t+4],7,4118548399),p=o(p,f,w,h,a[t+5],12,1200080426),h=o(h,p,f,w,a[t+6],17,2821735955),w=o(w,h,p,f,a[t+7],22,4249261313),f=o(f,w,h,p,a[t+8],7,1770035416),p=o(p,f,w,h,a[t+9],12,2336552879),h=o(h,p,f,w,a[t+10],17,4294925233),w=o(w,h,p,f,a[t+11],22,2304563134),f=o(f,w,h,p,a[t+12],7,1804603682),p=o(p,f,w,h,a[t+13],12,4254626195),h=o(h,p,f,w,a[t+14],17,2792965006),f=e(f,w=o(w,h,p,f,a[t+15],22,1236535329),h,p,a[t+1],5,4129170786),p=e(p,f,w,h,a[t+6],9,3225465664),h=e(h,p,f,w,a[t+11],14,643717713),w=e(w,h,p,f,a[t+0],20,3921069994),f=e(f,w,h,p,a[t+5],5,3593408605),p=e(p,f,w,h,a[t+10],9,38016083),h=e(h,p,f,w,a[t+15],14,3634488961),w=e(w,h,p,f,a[t+4],20,3889429448),f=e(f,w,h,p,a[t+9],5,568446438),p=e(p,f,w,h,a[t+14],9,3275163606),h=e(h,p,f,w,a[t+3],14,4107603335),w=e(w,h,p,f,a[t+8],20,1163531501),f=e(f,w,h,p,a[t+13],5,2850285829),p=e(p,f,w,h,a[t+2],9,4243563512),h=e(h,p,f,w,a[t+7],14,1735328473),f=r(f,w=e(w,h,p,f,a[t+12],20,2368359562),h,p,a[t+5],4,4294588738),p=r(p,f,w,h,a[t+8],11,2272392833),h=r(h,p,f,w,a[t+11],16,1839030562),w=r(w,h,p,f,a[t+14],23,4259657740),f=r(f,w,h,p,a[t+1],4,2763975236),p=r(p,f,w,h,a[t+4],11,1272893353),h=r(h,p,f,w,a[t+7],16,4139469664),w=r(w,h,p,f,a[t+10],23,3200236656),f=r(f,w,h,p,a[t+13],4,681279174),p=r(p,f,w,h,a[t+0],11,3936430074),h=r(h,p,f,w,a[t+3],16,3572445317),w=r(w,h,p,f,a[t+6],23,76029189),f=r(f,w,h,p,a[t+9],4,3654602809),p=r(p,f,w,h,a[t+12],11,3873151461),h=r(h,p,f,w,a[t+15],16,530742520),f=i(f,w=r(w,h,p,f,a[t+2],23,3299628645),h,p,a[t+0],6,4096336452),p=i(p,f,w,h,a[t+7],10,1126891415),h=i(h,p,f,w,a[t+14],15,2878612391),w=i(w,h,p,f,a[t+5],21,4237533241),f=i(f,w,h,p,a[t+12],6,1700485571),p=i(p,f,w,h,a[t+3],10,2399980690),h=i(h,p,f,w,a[t+10],15,4293915773),w=i(w,h,p,f,a[t+1],21,2240044497),f=i(f,w,h,p,a[t+8],6,1873313359),p=i(p,f,w,h,a[t+15],10,4264355552),h=i(h,p,f,w,a[t+6],15,2734768916),w=i(w,h,p,f,a[t+13],21,1309151649),f=i(f,w,h,p,a[t+4],6,4149444226),p=i(p,f,w,h,a[t+11],10,3174756917),h=i(h,p,f,w,a[t+2],15,718787259),w=i(w,h,p,f,a[t+9],21,3951481745),f=n(f,s),w=n(w,d),h=n(h,u),p=n(p,l);return(c(f)+c(w)+c(h)+c(p)).toLowerCase()}return p.toWechatPage=async function(t){const n=await m(window.location.href);w(d(t));const o=t+"_"+n;window.location=o},p.addHkLink=async function(t){d(t),f()},window.BFB=p,{}})()));